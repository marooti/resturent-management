<!-- Weekly Data Table -->
<div class="data-table h-full">
    <div class="mb-3">
        <span class="text-2xl font-medium ">Time Logs List </span>
    </div>
    <p-table scrollHeight="flex" [value]="allData" class="p-datatable-gridlines p-datatable-striped">
        <ng-template pTemplate="header">
            <tr class="p-2 bg-[#349ce4]">
                <th class="bg-[#1c4c74] p-3 text-white">
                    <span class="font-normal text-md">Name</span>
                </th>
                <th class="bg-[#1c4c74] p-3 text-white">
                    <span class="font-normal text-md">Date</span>

                </th>
                <th class="bg-[#1c4c74] p-3 text-white w-[120px]">
                    <span class="font-normal text-md">Total time</span>

                </th>

                <th class="bg-[#1c4c74] p-3 text-white">
                    <span class="font-normal text-md">Data</span>
                </th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-log>
            <tr>
                <td class=" p-3">
                    {{ log.id }}
                </td>
                <td class=" p-3" *ngFor="let data of getDateKeys(log)">
                    {{ data}}
                </td>
                <td>
                    <div>
                        {{processTimelo(log)}}
                    </div>
                </td>

                <td class=" p-3">
                    <div>
                        <ng-container *ngFor="let dateKey of getDateKeys(log)">
                            <ng-container *ngFor="let entry of log[dateKey]?.data; let i = index">
                                <div class="bg-gray-50 mb-2 p-2 rounded-md hover:bg-[#1c4c74] hover:text-white cursor-pointer"
                                    (click)="showingDialog(log ,entry, i)">
                                    <div>
                                        <span class="font-bold text-sm">Spent Time :</span> {{ entry.spentTame }}
                                    </div>
                                    <div>
                                        <span class="font-bold text-sm">Project Name :</span> {{ entry.issueName }}
                                    </div>
                                    <div>
                                        <span class="font-bold text-sm">Description :</span> {{ entry.description }}
                                    </div>
                                </div>
                            </ng-container>
                        </ng-container>
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>
</div>

<p-dialog [modal]="true" [(visible)]="visible" [style]="{ width: '25rem' }" class="p-3">
    <div class="p-3">
        <span class="text-xl font-semibold block pb-3 border-b-2">Log Time</span>
        <!-- <div class="align-items-center mt-3">
            <label class="text-sm ">Employee Name</label>
            <div class="mt-1">
                <p-dropdown [options]="employeeDropdown" [(ngModel)]="employeeName" optionLabel="name"
                    optionValue="name" placeholder="Select a issue" />
            </div>
        </div> -->
        <div class="align-items-center mt-3">
            <label class="text-sm ">Project <span class="text-red-500">*</span></label>
            <div class="mt-1 ">
                <p-dropdown [options]="issueName" [(ngModel)]="issueNameVlaue" optionValue="name" optionLabel="name"
                    placeholder="Select a Project" />
            </div>
        </div>
        <div class="align-items-center mt-3">
            <label class="text-sm ">Date <span class="text-red-500">*</span></label>
            <div class="mt-1 border-[0.5px] rounded-md">
                <p-calendar [readonlyInput]="true" [(ngModel)]="dateOf" inputId="range">
                </p-calendar>
            </div>
        </div>

        <div class="align-items-center mt-3">
            <label class="text-sm ">Time Spent <span class="text-red-500">*</span></label>
            <div class="mt-1">
                <input type="text" pInputText [(ngModel)]="timeSpent" placeholder="Enter your time" />
            </div>
            <label class="text-xs ">Enter a Duration (e.g. 12h 3m )</label>
            <!-- <div *ngIf="errorMessage" class="text-danger">
            <small>{{ errorMessage }}</small>
        </div> -->
        </div>
        <div class="align-items-center mt-3">
            <label class="text-sm ">Start Time <span class="text-red-500">*</span></label>
            <div class="mt-1 border-[0.5px] rounded-md">
                <p-calendar inputId="calendar-timeonly" [(ngModel)]="startTime" hourFormat="12" class="w-[100%]"
                    placeholder="Enter your start time" [timeOnly]="true"></p-calendar>
            </div>
        </div>

        <div class="align-items-center mt-3">
            <label class="text-sm ">Description <span class="text-red-500">*</span></label>
            <div class="mt-1">
                <textarea id="message" rows="4"
                    class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 
                   dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white !important dark:focus:ring-blue-500 dark:focus:border-blue-500"
                    placeholder="Write your thoughts here..." [(ngModel)]="description"></textarea>
            </div>

        </div>

        <div class="mt-3 justify-end flex">
            <button type="button" (click)="visible = false"
                class="focus:outline-none border-2 bg-white rounded-lg text-sm px-3 me-2  h-[35px]">
                Cancel </button>
            <button type="button" (click)="deleteIndex()"
                class="focus:outline-none text-white bg-[#1c4c74] rounded-lg text-sm px-3 me-2 dark:bg-green-600 h-[35px]">
                Delete
            </button>

            <button type="button" (click)="updateUI()"
                class="focus:outline-none text-white bg-[#1c4c74]  rounded-lg text-sm px-3 me-2 dark:bg-green-600  h-[35px]">
                Update
            </button>

        </div>
    </div>

</p-dialog>